# 变更日志

本文档记录项目的重要版本变更和功能更新。

## [v2.0.0] - 2025-01-XX - 智能每日练习量推荐系统

### 🧠 重大功能更新

#### 智能推荐系统
- 🎯 **每日练习量推荐**: 基于儿童心理学和教育学理论的智能推荐算法
- 📊 **用户学习画像**: 多维度分析用户学习能力、偏好和模式
- 🎨 **个性化体验**: 根据个体差异提供定制化学习建议
- 🏆 **心理支持机制**: 提升自主感、胜任感和成就感的系统性设计

#### 核心心理学机制
- **自主感增强**: 练习量选择权、个性化设置、目标自定义
- **胜任感建设**: 适应性难度调整、成功率维护、渐进式挑战
- **成就感激励**: SMART目标设定、进度可视化、努力-成果关联

### 📋 技术架构扩展

#### 后端新增
- 新增数据模型: `UserLearningProfile`, `DailyPracticeRecommendation`, `LearningSession`
- 推荐引擎: `RecommendationEngine` 核心算法实现
- 心理分析: 动机评估、胜任感评估、自主性需求分析
- API扩展: 10个新的RESTful端点支持推荐功能

#### 前端新增
- 组件架构: `Recommendation/`, `UserProfile/`, `PsychologicalSupport/` 组件群
- 状态管理: `RecommendationState`, `DailyGoal`, `LearningProgress` 接口
- 用户界面: 目标设定、进度追踪、动机激励面板

### 📚 文档完善

#### 新增文档
- `PSYCHOLOGICAL_FRAMEWORK.md`: 详细的心理学理论基础和实现策略
- `IMPLEMENTATION_PLAN.md`: Stage 7 智能推荐系统实施计划
- `ARCHITECTURE.md`: 扩展的技术架构文档

#### 理论基础
- 自我决定理论 (Self-Determination Theory)
- 认知负荷理论 (Cognitive Load Theory) 
- 目标设定理论 (Goal Setting Theory)
- 心流理论 (Flow Theory)

### 🎯 实施优先级

#### 高优先级 (MVP)
1. 基础推荐算法实现
2. 用户学习数据收集
3. 简单的目标设定界面
4. 基础进度追踪功能

#### 中优先级
1. 高级推荐算法优化
2. 心理支持系统
3. 详细数据分析功能
4. 个性化设置界面

#### 低优先级 (增强功能)
1. 社交功能和分享机制
2. 高级数据可视化
3. AI驱动的个性化建议
4. 跨平台数据同步

### 🔬 效果评估

- A/B测试框架设计
- 心理效果评估指标
- 持续优化机制
- 用户反馈收集系统

---

## [v1.5.0] - 2025-01-XX - 祝贺动画效果

### 新增

- 🎉 **祝贺动画系统**: 答对单词时显示彩色粒子爆炸效果
- 🔊 **音效支持**: 集成成功音效，支持OGG和MP3格式
- 🎛️ **用户控制**: 提供动画和音效的开关设置
- 📱 **响应式设计**: 根据设备性能自动调整粒子数量
- ⚡ **性能优化**: 1秒快速完成，不干扰学习流程

### 技术实现

- 创建`CelebrationEffect.tsx`组件实现粒子动画
- 开发`audioUtils.ts`音频工具，支持文件播放和Web Audio API回退
- 集成到主页面，在答对时自动触发
- 添加用户偏好设置，支持动画和音效独立控制

### 文件变更

- 新增: `frontend/src/components/CelebrationEffect.tsx`
- 新增: `frontend/src/utils/audioUtils.ts`
- 新增: `frontend/public/sounds/README.md`
- 修改: `frontend/pages/index.tsx`

## [v1.4.0] - 2025-01-XX - 局域网访问支持

### 新增

- 🌐 **局域网访问配置**: 支持在同一WiFi网络的其他设备上访问应用
- 🔧 **动态后端配置**: 通过环境变量`BACKEND_HOST`动态配置后端地址
- 📱 **跨设备测试**: 支持手机、平板等移动设备访问
- 🚀 **一键启动脚本**: 自动配置局域网访问的启动方式

### 改进

- 🔄 **前端网络配置**: 修改Next.js开发服务器绑定到`0.0.0.0`
- 🛠️ **API路由优化**: 使用相对路径和Next.js rewrite功能实现动态API路由
- 📖 **文档完善**: 详细的局域网访问配置说明和故障排除指南
- 🏗️ **架构文档更新**: 添加网络配置架构图和部署说明

### 修复

- 🐛 **API连接问题**: 解决其他设备访问时"加载单词中"卡住的问题
- 🔧 **端口冲突处理**: 完善端口占用检测和自动清理机制
- 🌐 **跨域配置**: 优化CORS设置支持局域网访问

### 技术变更

- 修改`frontend/package.json`的dev脚本为`next dev -H 0.0.0.0`
- 更新`frontend/next.config.js`支持动态后端地址配置
- 修改`frontend/pages/index.tsx`使用相对API路径
- 完善启动脚本的网络配置检测

### 文档更新

- 📚 **README.md**: 添加局域网访问配置章节
- 🚀 **STARTUP_GUIDE.md**: 详细的启动和故障排除说明
- 🏗️ **ARCHITECTURE.md**: 网络架构和部署配置文档
- 📋 **CHANGELOG.md**: 记录本次功能更新

## [v1.3.0] - 2025-08-13 - 用户体验优化

### 新增

- 🎯 实现输入框自动聚焦功能
- ⌨️ 单词加载完成后自动聚焦到输入框
- 🔄 答案提交后自动重新聚焦
- 📱 手动切换单词时自动聚焦

### 改进

- 🎨 优化输入体验，添加输入模式提示
- 🔧 关闭自动完成、自动纠错和拼写检查
- 📝 使用拉丁字符输入模式提示
- ⚡ 提升用户操作流畅性

### 修复

- 🐛 修复API端点不匹配问题（/api/check-answer）
- 🔧 解决TypeScript模块导入错误
- 📊 完善答案提交错误处理

### 技术变更

- 新增useRef钩子管理输入框引用
- 实现多场景自动聚焦逻辑
- 添加输入框优化属性（inputMode、autoComplete等）
- 修复React命名空间导入问题

## [v1.2.0] - 2025-01-XX - 开发流程优化

### 新增

- 📋 创建经验教训文档体系
- 🔧 建立功能修改决策流程（5个阶段）
- 📚 新增技术架构文档
- 🤝 建立用户确认机制

### 改进

- 🔄 优化开发规范文档结构
- 📖 完善文档交叉引用
- 🎯 强化影响评估要求
- 💬 建立标准化沟通模板

### 文档

- 新增 `docs/LESSONS_LEARNED.md` - 开发经验教训
- 新增 `docs/ARCHITECTURE.md` - 技术架构文档
- 更新 `DEVELOPMENT_RULES.md` - 增加决策流程

## [v1.1.0] - 2025-01-XX - 音频播放功能完善

### 新增

- 🔊 实现单词自动发音功能
- ⌨️ 添加音频播放快捷键（Shift+P）
- 🎵 支持有道API音频源
- 🔄 音频URL自动生成和修复

### 改进

- 🎯 优化音频播放优先级策略
- 🔧 完善音频处理错误处理
- 📱 改进前端音频播放体验
- 🚀 提升音频加载性能

### 修复

- 🐛 修复音频URL为空的问题
- 🔧 解决音频播放快捷键冲突
- 📊 修复数据库音频字段同步

### 技术变更

- 音频播放快捷键：P键 → Shift+P（避免输入冲突）
- 音频源优先级：有道API > Anki媒体 > 本地TTS
- 数据库：确保audio_url字段存储完整URL

## [v1.0.0] - 2025-08-13 - 系统扩展完成

### 新增

- 🎯 完整的单词学习系统
- 🤖 Google Gemini AI集成
- 🃏 Anki深度集成
- 📊 扩展数据模型（7个新字段）
- 🎨 现代化前端界面
- 🔧 完整的开发环境配置

### 核心功能

- ✅ 单词显示和学习
- ✅ 用户输入和反馈
- ✅ 图片和音频支持
- ✅ 键盘快捷键
- ✅ 调试面板
- ✅ Anki数据同步

### 数据模型

新增字段：

- `phonetic` - 音标
- `etymology` - 词源
- `exam_frequency` - 考试频率
- `star_level` - 星级
- `example_sentence` - 真题例句
- `example_translation` - 例句释义
- `related_words` - 相关词

### 技术栈

- **前端**: Next.js + TypeScript + Tailwind CSS
- **后端**: Flask + SQLAlchemy + SQLite
- **AI**: Google Gemini 2.0-Flash
- **集成**: AnkiConnect API
- **音频**: 有道API + 本地TTS

## [v0.1.0] - 项目初始化

### 新增

- 🏗️ 基础项目结构
- 🔧 开发环境配置
- 📝 初始文档

---

## 版本说明

### 版本号规则

- **主版本号**: 重大架构变更或不兼容更新
- **次版本号**: 新功能添加或重要改进
- **修订号**: 问题修复和小幅优化

### 变更类型

- 🎯 **新增**: 新功能或新特性
- 🔄 **改进**: 现有功能优化
- 🐛 **修复**: 问题修复
- 📚 **文档**: 文档更新
- 🔧 **技术**: 技术架构变更
- ⚠️ **破坏性变更**: 不兼容的重大变更

### 相关文档

- [开发规范](../DEVELOPMENT_RULES.md)
- [经验教训](LESSONS_LEARNED.md)
- [技术架构](ARCHITECTURE.md)

---

**维护说明**: 每次重要功能发布后更新此文档，记录关键变更和影响。
